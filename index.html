<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <title>Placar Vôlei</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <button class="gear-button" onclick="toggleMenu()">
    <i class="fa-solid fa-bars"></i>
  </button>
  <div class="overlay" id="menuOverlay"></div>
  <div class="menu" id="gearMenu">
    <button onclick="navigateTo('pontuacao')"><i class="fa-solid fa-medal" style="margin-right:.5rem;"></i>Pontuação</button>
    <button onclick="navigateTo('times')"><i class="fa-solid fa-shuffle" style="margin-right:.5rem;"></i>Times</button>
    <button onclick="navigateTo('jogadores')"><i class="fa-solid fa-users" style="margin-right:.5rem;"></i>Jogadores</button>
    <button onclick="navigateTo('agendamentos')"><i class="fa-solid fa-calendar-alt" style="margin-right:.5rem;"></i>Agendamentos</button>
    <button onclick="navigateTo('configuracoes')"><i class="fa-solid fa-gear" style="margin-right:.5rem;"></i>Configurações</button>
    <button id="resetGameButton" class="disabled" onclick="confirmReset()"><i class="fa-solid fa-rotate-right" style="margin-right:.5rem;"></i>Reiniciar Partida</button>
  </div>
  <div id="pontuacao" class="section">
    <div class="scoreboard-overlay" id="scoreboardOverlay"></div>
    <div class="scoreboard">
      <div class="team-section" id="sectionA">
        <div class="victory-elements">
          <div class="crown-container">
            <i class="fa-solid fa-crown crown-icon"></i>
          </div>
          <div class="confetti-container"></div>
        </div>
        <div class="set-indicators left" id="setIndicatorA"></div>
        <div class="team-name" id="teamNameA"></div>
        <div class="player-info-container top-left">
          <ul class="player-list" id="playerListA"></ul>
        </div>
        <div class="score" id="scoreA">0</div>
      </div>
      <div class="team-section" id="sectionB">
        <div class="victory-elements">
          <div class="crown-container">
            <i class="fa-solid fa-crown crown-icon"></i>
          </div>
          <div class="confetti-container"></div>
        </div>
        <div class="set-indicators right" id="setIndicatorB"></div>
        <div class="team-name" id="teamNameB"></div>
        <div class="player-info-container top-left">
          <ul class="player-list" id="playerListB"></ul>
        </div>
        <div class="score" id="scoreB">0</div>
      </div>
    </div>
    <button class="btn start-game-button" id="startGameButton" onclick="showStartGameModal()">Iniciar Partida</button>
    <button class="swap-teams-button" id="swapTeamsButton" onclick="swapTeams()">
      <i class="fa-solid fa-right-left"></i>
    </button>
    <div class="game-timer" id="gameTimer" onclick="toggleTimer()">
      <div class="timer-main">
        <span id="timerDisplay">00:00</span>
        <i id="timerIcon" class="fa-solid fa-play"></i>
      </div>
      <div class="timer-set">
        Set: <span id="setTimerDisplay">00:00</span>
      </div>
    </div>
  </div>
  <div id="times" class="section">
    <h2 style="margin: 0px 0px 10px 0px;">Gerar Times</h2>
    <span class="adicionar">
      <button class="btn" onclick="generateCustomTeams()" style="width: 100%;">Gerar</button>
    </span>
    <div class="teams-display-container" id="teamsContainer"></div>
  </div>
  <div id="jogadores" class="section">
    <h2>Jogadores</h2>
    <span class="adicionar">
      <input type="text" id="playerName" placeholder="Nome do jogador" />
      <button class="btn" onclick="addPlayer()">Adicionar</button>
    </span>
    <span style="display:flex;flex-direction:row-reverse;justify-content:space-between;">
      <div id="playerCounter">0/0</div>
      <div style="display:flex;gap:1rem;margin-bottom:1rem;">
        <button class="btn" id="toggleSelectAllButton" onclick="toggleSelectAllPlayers()">Alternar Seleção</button>
      </div>
    </span>
    <ul id="playerList"></ul>
  </div>
  <div id="agendamentos" class="section">
    <h2 style="margin-bottom:10px;">Agendamentos de Jogos</h2>
    <div class="input-row">
      <div class="input-group">
        <label for="gameDate">Data:</label>
        <input type="date" id="gameDate">
      </div>
      <div class="input-group">
        <label for="gameTime">Hora:</label>
        <input type="time" id="gameTime">
      </div>
    </div>
    <div class="input-row">
      <div class="input-group" style="flex: 100%;"> <label for="gameLocation">Local:</label>
        <input type="text" id="gameLocation" placeholder="Ex: Praia, Ginásio X">
      </div>
    </div>
    <button class="btn" onclick="addAppointment()">Adicionar Agendamento</button>
    <h3 style="margin: 20px 0px 10px 0px;">Próximos Jogos</h3>
    <ul id="upcomingAppointmentsList"></ul>
    <div class="collapsible-container">
        <div class="collapsible-header" onclick="togglePastAppointmentsSection()">
            <h3>Jogos Anteriores</h3>
            <i class="fa-solid fa-chevron-right collapsible-arrow" id="pastAppointmentsArrow"></i>
        </div>
        <div class="collapsible-content" id="pastAppointmentsContent">
            <ul id="pastAppointmentsList"></ul>
        </div>
    </div>
  </div>
  <div id="configuracoes" class="section">
    <h2 style="margin-bottom:20px;">Configurações</h2>
    <div class="collapsible-container">
        <div class="collapsible-header" onclick="toggleGeneralSettingsSection()">
            <h3>Geral</h3>
            <i class="fa-solid fa-chevron-right collapsible-arrow" id="generalSettingsArrow"></i>
        </div>
        <div class="collapsible-content" id="generalSettingsContent">
          <div class="config-group">
            <label for="playersPerTeam">Jogadores por time:</label>
            <input type="number" id="playersPerTeam" min="1" value="4" onchange="saveLocalSettings()">
          </div>
          <div class="config-group">
            <label for="winningScore">Pontos para Vencer (Set):</label>
            <input type="number" id="winningScore" min="1" value="15" onchange="saveLocalSettings()">
          </div>
          <div class="config-group">
            <label for="setsToWinConfig">Número de Sets para Vencer a Partida (0 para ilimitado):</label>
            <input type="number" id="setsToWinConfig" min="0" value="0" onchange="saveLocalSettings()">
          </div>
          <div class="config-group">
            <label for="themeSelect">Tema:</label>
            <select id="themeSelect" onchange="setTheme(this.value)">
              <option value="dark">Escuro</option>
              <option value="light">Claro</option>
            </select>
          </div>
          <span style="display:flex;">
            <div class="checkbox-group">
              <label for="vibrationEnabled">Vibração ao Pontuar:</label>
              <input type="checkbox" id="vibrationEnabled" onchange="saveLocalSettings()">
            </div>
            <div class="checkbox-group" style="margin-left:20px;">
              <label for="showPlayersOnScoreboard">Exibir Jogadores no Placar:</label>
              <input type="checkbox" id="showPlayersOnScoreboard" onchange="saveLocalSettings()">
            </div>
          </span>
        </div>
    </div>
    <div class="collapsible-container">
        <div class="collapsible-header" onclick="toggleCustomTeamNamesSection()">
            <h3>Times Personalizados</h3> <i class="fa-solid fa-chevron-right collapsible-arrow" id="customTeamNamesArrow"></i>
        </div>
        <div class="collapsible-content" id="customTeamNamesContent">
            <p style="font-size:.9em;color:var(--text-color);opacity:.8;margin-bottom:.5rem;">Defina nomes e cores para seus times favoritos. Eles aparecerão nas opções de seleção e ao gerar times.</p>
            <div class="config-group color-picker-group">
                <label for="customTeamName1">Time 1:</label>
                <input type="text" id="customTeamName1" value="" onchange="saveCustomTeamNamesToFirestore()" style="flex:1;">
                <input type="color" id="customTeamColor1" value="#007bff" onchange="saveCustomTeamNamesToFirestore()">
            </div>
            <div class="config-group color-picker-group">
                <label for="customTeamName2">Time 2:</label>
                <input type="text" id="customTeamName2" value="" onchange="saveCustomTeamNamesToFirestore()" style="flex:1;">
                <input type="color" id="customTeamColor2" value="#dc3545" onchange="saveCustomTeamNamesToFirestore()">
            </div>
            <div class="config-group color-picker-group">
                <label for="customTeamName3">Time 3:</label>
                <input type="text" id="customTeamName3" value="" onchange="saveCustomTeamNamesToFirestore()" style="flex:1;">
                <input type="color" id="customTeamColor3" value="#28a745" onchange="saveCustomTeamNamesToFirestore()">
            </div>
            <div class="config-group color-picker-group">
                <label for="customTeamName4">Time 4:</label>
                <input type="text" id="customTeamName4" value="" onchange="saveCustomTeamNamesToFirestore()" style="flex:1;">
                <input type="color" id="customTeamColor4" value="#ffc107" onchange="saveCustomTeamNamesToFirestore()">
            </div>
            <div class="config-group color-picker-group">
                <label for="customTeamName5">Time 5:</label>
                <input type="text" id="customTeamName5" value="" onchange="saveCustomTeamNamesToFirestore()" style="flex:1;">
                <input type="color" id="customTeamColor5" value="#6f42c1" onchange="saveCustomTeamNamesToFirestore()">
            </div>
        </div>
    </div>
    <div class="collapsible-container">
        <div class="collapsible-header" onclick="toggleDataManagementSection()">
            <h3>Gerenciamento de Dados</h3> <i class="fa-solid fa-chevron-right collapsible-arrow" id="dataManagementArrow"></i>
        </div>
        <div class="collapsible-content" id="dataManagementContent">
            <div class="config-group">
                <label>Exportar Dados Locais:</label>
                <button class="btn" onclick="exportSettings()">Exportar Configurações</button>
            </div>
            <div class="config-group">
                <label>Importar Dados Locais:</label>
                <input type="file" id="importFileInput" accept=".json" style="display:none;" onchange="importSettings(event)">
                <button class="btn" onclick="document.getElementById('importFileInput').click()">Importar Configurações</button>
            </div>
            <div class="config-group">
                <label>Resetar Tudo:</label>
                <button class="btn" onclick="confirmResetAllData()" style="background-color: #dc3545;">Resetar Todos os Dados</button>
            </div>
        </div>
    </div>
    <div class="config-group" style="margin-top: 20px; text-align: center; padding: 15px; border-radius: 10px; background-color: var(--setting-section-bg); border: 1px solid var(--setting-item-border);">
        <label style="font-size: 1.1em; margin-bottom: 5px; color: var(--text-color);">Versão do Sistema:</label>
        <span id="systemVersionDisplay" style="font-weight: bold; font-size: 1.2em; color: var(--text-color);">Carregando...</span>
    </div>
    <div class="config-group" style="margin-top: 20px; text-align: center; padding: 15px; border-radius: 10px; background-color: var(--setting-section-bg); border: 1px solid var(--setting-item-border);">
        <label style="font-size: 1.1em; margin-bottom: 5px; color: var(--text-color);">ID do Usuário:</label>
        <span id="userIdDisplay" style="font-weight: bold; font-size: 0.9em; color: var(--text-color);">Carregando...</span>
    </div>
  </div>
  <div id="gameOverModal" class="game-over-modal">
    <div class="modal-content">
      <h3 id="modalWinningTeamName"></h3>
      <p id="modalMessage"></p>
      <div class="modal-buttons">
        <button onclick="startNewGame()">Novo Jogo</button>
        <button id="newSetButton" onclick="startNewSet()">Novo Set</button>
        <button onclick="increaseWinningScoreModal()">Continuar partida</button>
      </div>
    </div>
  </div>
  <div id="increaseScoreModal" class="increase-score-modal">
    <div class="increase-score-content">
      <h3>Aumentar Pontuação</h3>
      <p>Defina o novo valor para a pontuação de vitória do set:</p>
      <input type="number" id="newWinningScoreInput" min="1" value="15">
      <div class="modal-buttons">
        <button onclick="confirmIncreaseWinningScore()">Confirmar</button>
        <button onclick="hideIncreaseScoreModal()">Cancelar</button>
      </div>
    </div>
  </div>
  <div id="startGameModal" class="start-game-modal">
    <div class="start-game-content">
      <h3>Iniciar Nova Partida</h3>
      <p>Defina as configurações da partida:</p>
      <div class="input-row">
        <div class="input-group">
          <label for="initialWinningScore">Pontos por set:</label>
          <input type="number" id="initialWinningScore" min="1" value="15">
        </div>
        <div class="input-group">
          <label for="initialNumberOfSets">Número de sets:</label>
          <input type="number" id="initialNumberOfSets" min="0" value="0">
        </div>
      </div>
      <div class="modal-buttons">
        <button id="modalStartGameButton" onclick="confirmStartGame()">Iniciar Partida</button>
        <button onclick="hideStartGameModal()" style="background-color:#dc3545;--modal-button-hover-bg:#c82333;">Cancelar</button>
      </div>
    </div>
  </div>
  <div id="superVictoryModal" class="super-victory-modal">
    <div class="super-victory-content">
      <h3 id="superVictoryTeamName"></h3>
      <p>VENCEU A PARTIDA!</p>
      <div class="confetti-container" style="position:absolute;top:0;left:0;width:100%;height:100%;"></div>
    </div>
  </div>
  <div id="manageTeamModal" class="manage-team-modal">
    <div class="modal-content manage-team-content">
      <h3 id="manageTeamModalTitle">Selecionar Time</h3>
      <div class="input-group" style="width:100%;">
        <label for="selectTeamForManagement">Selecione um time:</label>
        <select id="selectTeamForManagement" onchange="saveTeamNameAndPlayers()"></select>
      </div>
    </div>
  </div>

  <div id="updateBanner" class="update-banner">
    <span>Nova versão disponível!</span>
    <button onclick="reloadApp()">Atualizar</button>
  </div>

  <script type="module" src="script.js"></script>
</body>
</html>
